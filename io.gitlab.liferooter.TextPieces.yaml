# SPDX-FileCopyrightText: 2023 Gleb Smirnov <glebsmirnov0708@gmail.com>
#
# SPDX-License-Identifier: CC0-1.0

id: io.gitlab.liferooter.TextPieces

runtime: org.gnome.Platform
runtime-version: '49'

sdk: org.gnome.Sdk
sdk-extensions:
- org.freedesktop.Sdk.Extension.rust-stable

command: textpieces

finish-args:
- --socket=fallback-x11
- --socket=wayland
- --device=dri
- --share=ipc
- --talk-name=org.freedesktop.Flatpak
- --filesystem=~/.local/share/textpieces

modules:

- name: blueprint-compiler
  buildsystem: meson
  cleanup:
  - '*'
  sources:
  - type: git
    url: https://gitlab.gnome.org/jwestman/blueprint-compiler
    tag: v0.18.0

- name: textpieces
  buildsystem: meson
  build-options:
    append-path: /usr/lib/sdk/rust-stable/bin
  sources:
  - type: archive
    url: https://gitlab.com/liferooter/textpieces/-/archive/v4.3.0/textpieces-v4.3.0.tar.gz
    sha256: 73fc923030f326b8160f02a33a348f606931b5b92c384d887473bcb789c76011
  - cargo-sources.json
  - type: shell
    commands:
    - mkdir .cargo
    - cp cargo/config .cargo/config.toml
